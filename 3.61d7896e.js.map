{"version":3,"sources":["webpack:///./node_modules/lodash/sortBy.js","webpack:///./node_modules/lodash/_baseOrderBy.js","webpack:///./node_modules/lodash/_baseMap.js","webpack:///./node_modules/lodash/_baseSortBy.js","webpack:///./node_modules/lodash/_compareMultiple.js","webpack:///./node_modules/lodash/_compareAscending.js","webpack:///./node_modules/lodash/_isIterateeCall.js","webpack:///./node_modules/lodash/xor.js","webpack:///./node_modules/lodash/_baseXor.js","webpack:///./node_modules/mirador/dist/es/src/components/AnnotationsOverlay.js","webpack:///./node_modules/mirador/dist/es/src/containers/AnnotationsOverlay.js","webpack:///./node_modules/mirador/dist/es/src/plugins/OSDReferences.js","webpack:///./node_modules/mirador/dist/es/src/components/OpenSeadragonViewer.js","webpack:///./node_modules/mirador/dist/es/src/containers/OpenSeadragonViewer.js"],"names":["baseFlatten","baseOrderBy","baseRest","isIterateeCall","sortBy","collection","iteratees","length","module","exports","arrayMap","baseGet","baseIteratee","baseMap","baseSortBy","baseUnary","compareMultiple","identity","isArray","orders","iteratee","value","index","result","key","object","other","baseEach","isArrayLike","Array","array","comparer","sort","compareAscending","objCriteria","criteria","othCriteria","ordersLength","isSymbol","valIsDefined","undefined","valIsNull","valIsReflexive","valIsSymbol","othIsDefined","othIsNull","othIsReflexive","othIsSymbol","eq","isIndex","isObject","type","arrayFilter","baseXor","isArrayLikeObject","xor","arrays","baseDifference","baseUniq","comparator","othIndex","ownKeys","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","source","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","configurable","writable","_toConsumableArray","arr","_arrayLikeToArray","_arrayWithoutHoles","iter","Symbol","iterator","from","_iterableToArray","_unsupportedIterableToArray","TypeError","_nonIterableSpread","_slicedToArray","_arrayWithHoles","_i","_s","_e","_arr","_n","_d","call","next","done","err","_iterableToArrayLimit","_nonIterableRest","o","minLen","n","prototype","toString","slice","constructor","name","test","len","arr2","_defineProperties","props","descriptor","_setPrototypeOf","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","Reflect","construct","sham","Proxy","Boolean","valueOf","e","_isNativeReflectConstruct","Super","_getPrototypeOf","NewTarget","this","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","getPrototypeOf","_Component","subClass","superClass","create","_inherits","AnnotationsOverlay","Constructor","protoProps","staticProps","_super","_this","instance","_classCallCheck","ref","createRef","osdCanvasOverlay","updateCanvas","onUpdateViewport","bind","onCanvasClick","onCanvasMouseMove","onCanvasExit","currentAnnotations","prevAnnotations","every","annotation","newIds","resources","map","r","id","prevIds","initializeViewer","prevProps","_this$props","drawAnnotations","drawSearchAnnotations","annotations","searchAnnotations","hoveredAnnotationIds","selectedAnnotationId","highlightAllAnnotations","viewer","annotationsUpdated","annotationsMatch","searchAnnotationsUpdated","hoveredAnnotationsUpdated","canvasDiv","style","cursor","selectedAnnotationsUpdated","redrawAnnotations","canvasUpdateCallback","forceRedraw","removeHandler","event","_this2","canvasWorld","webPosition","position","point","eventSource","viewport","pointFromPixel","canvas","canvasAtPoint","_canvasWorld$canvasTo2","canvasToWorldCoordinates","canvasWidth","canvasHeight","annos","annotationsAtPoint","preventDefaultAction","toggleAnnotation","annosWithClickScore","radius","degreesToRadians","Math","PI","anno","score","degrees","x","cos","y","sin","isAnnotationAtPoint","annosWithScore","max","_this$props2","hoverAnnotation","windowId","a","_this$props3","cancel","OpenSeadragonCanvasOverlay","addHandler","_this3","clear","resize","canvasUpdate","renderAnnotations","resource","_canvasWorld$canvasTo4","canvasX","canvasY","relativeX","relativeY","svgSelector","context","context2d","CanvasAnnotationDisplay","svgPaths","some","path","isPointInPath","Path2D","attributes","d","nodeValue","fragmentSelector","_resource$fragmentSel","w","h","_this4","_this$props4","lists","concat","l","targetId","_this$props5","selectAnnotation","deselectAnnotation","palette","_this$props6","zoomRatio","getZoom","getMaxZoom","canvasIds","includes","offset","offsetByCanvas","hovered","hidden","selected","toContext","_this$props7","annotationsToContext","search","createPortal","createElement","height","left","top","width","Fragment","defaultProps","mapDispatchToProps","withTranslation","state","_ref","window","forceDrawAnnotations","content","withPlugins","OSDReferences","get","refs","set","_construct","Parent","args","Class","Function","OpenSeadragonViewer","apiRef","onViewportChange","zoomToWorld","osdUpdating","osdConfig","t","current","firstElementChild","setAttribute","setState","innerTracker","moveHandler","prevState","viewerConfig","panTo","zoomTo","zoom","setRotation","flip","setFlip","addAllImageSources","infoResponsesMatch","infoResponses","nonTiledImagedMatch","nonTiledImages","layers","centerSpringX","centerSpringY","zoomSpring","rotation","getRotation","getFlip","refreshTileProperties","close","canvasesChanged","removeAllHandlers","raiseEvent","updateViewport","round","zoomAfterAdd","Promise","all","infoResponse","addTileSource","image","addNonTiledImage","then","contentResource","getProperty","format","startsWith","resolve","reject","addSimpleImage","error","fitBounds","Rect","contentResourceToWorldCoordinates","layerIndexOfImageResource","opacity","layerOpacityOfImageResource","success","url","tileSource","json","addTiledImage","world","items","getItemCount","getItemAt","item","newIndex","setItemIndex","setOpacity","immediately","prevInfoResponses","tokenServiceId","prevNonTiledImages","worldBounds","children","classes","label","enhancedChildren","Children","child","cloneElement","className","osdContainer","PluginHook","assign","withStyles","flex","imageServiceIds","canvases","c","isFetching","canvasId"],"mappings":"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","file":"3.61d7896e.js","sourcesContent":["var baseFlatten = require('./_baseFlatten'),\n    baseOrderBy = require('./_baseOrderBy'),\n    baseRest = require('./_baseRest'),\n    isIterateeCall = require('./_isIterateeCall');\n\n/**\n * Creates an array of elements, sorted in ascending order by the results of\n * running each element in a collection thru each iteratee. This method\n * performs a stable sort, that is, it preserves the original sort order of\n * equal elements. The iteratees are invoked with one argument: (value).\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {...(Function|Function[])} [iteratees=[_.identity]]\n *  The iteratees to sort by.\n * @returns {Array} Returns the new sorted array.\n * @example\n *\n * var users = [\n *   { 'user': 'fred',   'age': 48 },\n *   { 'user': 'barney', 'age': 36 },\n *   { 'user': 'fred',   'age': 30 },\n *   { 'user': 'barney', 'age': 34 }\n * ];\n *\n * _.sortBy(users, [function(o) { return o.user; }]);\n * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 30]]\n *\n * _.sortBy(users, ['user', 'age']);\n * // => objects for [['barney', 34], ['barney', 36], ['fred', 30], ['fred', 48]]\n */\nvar sortBy = baseRest(function(collection, iteratees) {\n  if (collection == null) {\n    return [];\n  }\n  var length = iteratees.length;\n  if (length > 1 && isIterateeCall(collection, iteratees[0], iteratees[1])) {\n    iteratees = [];\n  } else if (length > 2 && isIterateeCall(iteratees[0], iteratees[1], iteratees[2])) {\n    iteratees = [iteratees[0]];\n  }\n  return baseOrderBy(collection, baseFlatten(iteratees, 1), []);\n});\n\nmodule.exports = sortBy;\n","var arrayMap = require('./_arrayMap'),\n    baseGet = require('./_baseGet'),\n    baseIteratee = require('./_baseIteratee'),\n    baseMap = require('./_baseMap'),\n    baseSortBy = require('./_baseSortBy'),\n    baseUnary = require('./_baseUnary'),\n    compareMultiple = require('./_compareMultiple'),\n    identity = require('./identity'),\n    isArray = require('./isArray');\n\n/**\n * The base implementation of `_.orderBy` without param guards.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function[]|Object[]|string[]} iteratees The iteratees to sort by.\n * @param {string[]} orders The sort orders of `iteratees`.\n * @returns {Array} Returns the new sorted array.\n */\nfunction baseOrderBy(collection, iteratees, orders) {\n  if (iteratees.length) {\n    iteratees = arrayMap(iteratees, function(iteratee) {\n      if (isArray(iteratee)) {\n        return function(value) {\n          return baseGet(value, iteratee.length === 1 ? iteratee[0] : iteratee);\n        }\n      }\n      return iteratee;\n    });\n  } else {\n    iteratees = [identity];\n  }\n\n  var index = -1;\n  iteratees = arrayMap(iteratees, baseUnary(baseIteratee));\n\n  var result = baseMap(collection, function(value, key, collection) {\n    var criteria = arrayMap(iteratees, function(iteratee) {\n      return iteratee(value);\n    });\n    return { 'criteria': criteria, 'index': ++index, 'value': value };\n  });\n\n  return baseSortBy(result, function(object, other) {\n    return compareMultiple(object, other, orders);\n  });\n}\n\nmodule.exports = baseOrderBy;\n","var baseEach = require('./_baseEach'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * The base implementation of `_.map` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction baseMap(collection, iteratee) {\n  var index = -1,\n      result = isArrayLike(collection) ? Array(collection.length) : [];\n\n  baseEach(collection, function(value, key, collection) {\n    result[++index] = iteratee(value, key, collection);\n  });\n  return result;\n}\n\nmodule.exports = baseMap;\n","/**\n * The base implementation of `_.sortBy` which uses `comparer` to define the\n * sort order of `array` and replaces criteria objects with their corresponding\n * values.\n *\n * @private\n * @param {Array} array The array to sort.\n * @param {Function} comparer The function to define sort order.\n * @returns {Array} Returns `array`.\n */\nfunction baseSortBy(array, comparer) {\n  var length = array.length;\n\n  array.sort(comparer);\n  while (length--) {\n    array[length] = array[length].value;\n  }\n  return array;\n}\n\nmodule.exports = baseSortBy;\n","var compareAscending = require('./_compareAscending');\n\n/**\n * Used by `_.orderBy` to compare multiple properties of a value to another\n * and stable sort them.\n *\n * If `orders` is unspecified, all values are sorted in ascending order. Otherwise,\n * specify an order of \"desc\" for descending or \"asc\" for ascending sort order\n * of corresponding values.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {boolean[]|string[]} orders The order to sort by for each property.\n * @returns {number} Returns the sort order indicator for `object`.\n */\nfunction compareMultiple(object, other, orders) {\n  var index = -1,\n      objCriteria = object.criteria,\n      othCriteria = other.criteria,\n      length = objCriteria.length,\n      ordersLength = orders.length;\n\n  while (++index < length) {\n    var result = compareAscending(objCriteria[index], othCriteria[index]);\n    if (result) {\n      if (index >= ordersLength) {\n        return result;\n      }\n      var order = orders[index];\n      return result * (order == 'desc' ? -1 : 1);\n    }\n  }\n  // Fixes an `Array#sort` bug in the JS engine embedded in Adobe applications\n  // that causes it, under certain circumstances, to provide the same value for\n  // `object` and `other`. See https://github.com/jashkenas/underscore/pull/1247\n  // for more details.\n  //\n  // This also ensures a stable sort in V8 and other engines.\n  // See https://bugs.chromium.org/p/v8/issues/detail?id=90 for more details.\n  return object.index - other.index;\n}\n\nmodule.exports = compareMultiple;\n","var isSymbol = require('./isSymbol');\n\n/**\n * Compares values to sort them in ascending order.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {number} Returns the sort order indicator for `value`.\n */\nfunction compareAscending(value, other) {\n  if (value !== other) {\n    var valIsDefined = value !== undefined,\n        valIsNull = value === null,\n        valIsReflexive = value === value,\n        valIsSymbol = isSymbol(value);\n\n    var othIsDefined = other !== undefined,\n        othIsNull = other === null,\n        othIsReflexive = other === other,\n        othIsSymbol = isSymbol(other);\n\n    if ((!othIsNull && !othIsSymbol && !valIsSymbol && value > other) ||\n        (valIsSymbol && othIsDefined && othIsReflexive && !othIsNull && !othIsSymbol) ||\n        (valIsNull && othIsDefined && othIsReflexive) ||\n        (!valIsDefined && othIsReflexive) ||\n        !valIsReflexive) {\n      return 1;\n    }\n    if ((!valIsNull && !valIsSymbol && !othIsSymbol && value < other) ||\n        (othIsSymbol && valIsDefined && valIsReflexive && !valIsNull && !valIsSymbol) ||\n        (othIsNull && valIsDefined && valIsReflexive) ||\n        (!othIsDefined && valIsReflexive) ||\n        !othIsReflexive) {\n      return -1;\n    }\n  }\n  return 0;\n}\n\nmodule.exports = compareAscending;\n","var eq = require('./eq'),\n    isArrayLike = require('./isArrayLike'),\n    isIndex = require('./_isIndex'),\n    isObject = require('./isObject');\n\n/**\n * Checks if the given arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n *  else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n        ? (isArrayLike(object) && isIndex(index, object.length))\n        : (type == 'string' && index in object)\n      ) {\n    return eq(object[index], value);\n  }\n  return false;\n}\n\nmodule.exports = isIterateeCall;\n","var arrayFilter = require('./_arrayFilter'),\n    baseRest = require('./_baseRest'),\n    baseXor = require('./_baseXor'),\n    isArrayLikeObject = require('./isArrayLikeObject');\n\n/**\n * Creates an array of unique values that is the\n * [symmetric difference](https://en.wikipedia.org/wiki/Symmetric_difference)\n * of the given arrays. The order of result values is determined by the order\n * they occur in the arrays.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Array\n * @param {...Array} [arrays] The arrays to inspect.\n * @returns {Array} Returns the new array of filtered values.\n * @see _.difference, _.without\n * @example\n *\n * _.xor([2, 1], [2, 3]);\n * // => [1, 3]\n */\nvar xor = baseRest(function(arrays) {\n  return baseXor(arrayFilter(arrays, isArrayLikeObject));\n});\n\nmodule.exports = xor;\n","var baseDifference = require('./_baseDifference'),\n    baseFlatten = require('./_baseFlatten'),\n    baseUniq = require('./_baseUniq');\n\n/**\n * The base implementation of methods like `_.xor`, without support for\n * iteratee shorthands, that accepts an array of arrays to inspect.\n *\n * @private\n * @param {Array} arrays The arrays to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of values.\n */\nfunction baseXor(arrays, iteratee, comparator) {\n  var length = arrays.length;\n  if (length < 2) {\n    return length ? baseUniq(arrays[0]) : [];\n  }\n  var index = -1,\n      result = Array(length);\n\n  while (++index < length) {\n    var array = arrays[index],\n        othIndex = -1;\n\n    while (++othIndex < length) {\n      if (othIndex != index) {\n        result[index] = baseDifference(result[index] || array, arrays[othIndex], iteratee, comparator);\n      }\n    }\n  }\n  return baseUniq(baseFlatten(result, 1), iteratee, comparator);\n}\n\nmodule.exports = baseXor;\n","function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (typeof call === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nimport React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport isEqual from 'lodash/isEqual';\nimport debounce from 'lodash/debounce';\nimport flatten from 'lodash/flatten';\nimport sortBy from 'lodash/sortBy';\nimport xor from 'lodash/xor';\nimport OpenSeadragonCanvasOverlay from '../lib/OpenSeadragonCanvasOverlay';\nimport CanvasWorld from '../lib/CanvasWorld';\nimport CanvasAnnotationDisplay from '../lib/CanvasAnnotationDisplay';\n/**\n * Represents a OpenSeadragonViewer in the mirador workspace. Responsible for mounting\n * and rendering OSD.\n */\n\nexport var AnnotationsOverlay = /*#__PURE__*/function (_Component) {\n  _inherits(AnnotationsOverlay, _Component);\n\n  var _super = _createSuper(AnnotationsOverlay);\n\n  /**\n   * @param {Object} props\n   */\n  function AnnotationsOverlay(props) {\n    var _this;\n\n    _classCallCheck(this, AnnotationsOverlay);\n\n    _this = _super.call(this, props);\n    _this.ref = /*#__PURE__*/React.createRef();\n    _this.osdCanvasOverlay = null; // An initial value for the updateCanvas method\n\n    _this.updateCanvas = function () {};\n\n    _this.onUpdateViewport = _this.onUpdateViewport.bind(_assertThisInitialized(_this));\n    _this.onCanvasClick = _this.onCanvasClick.bind(_assertThisInitialized(_this));\n    _this.onCanvasMouseMove = debounce(_this.onCanvasMouseMove.bind(_assertThisInitialized(_this)), 10);\n    _this.onCanvasExit = _this.onCanvasExit.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n  /**\n   * React lifecycle event\n   */\n\n\n  _createClass(AnnotationsOverlay, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.initializeViewer();\n    }\n    /**\n     * When the tileSources change, make sure to close the OSD viewer.\n     * When the annotations change, reset the updateCanvas method to make sure\n     * they are added.\n     * When the viewport state changes, pan or zoom the OSD viewer as appropriate\n     */\n\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var _this$props = this.props,\n          drawAnnotations = _this$props.drawAnnotations,\n          drawSearchAnnotations = _this$props.drawSearchAnnotations,\n          annotations = _this$props.annotations,\n          searchAnnotations = _this$props.searchAnnotations,\n          hoveredAnnotationIds = _this$props.hoveredAnnotationIds,\n          selectedAnnotationId = _this$props.selectedAnnotationId,\n          highlightAllAnnotations = _this$props.highlightAllAnnotations,\n          viewer = _this$props.viewer;\n      this.initializeViewer();\n      var annotationsUpdated = !AnnotationsOverlay.annotationsMatch(annotations, prevProps.annotations);\n      var searchAnnotationsUpdated = !AnnotationsOverlay.annotationsMatch(searchAnnotations, prevProps.searchAnnotations);\n      var hoveredAnnotationsUpdated = xor(hoveredAnnotationIds, prevProps.hoveredAnnotationIds).length > 0;\n\n      if (this.osdCanvasOverlay && hoveredAnnotationsUpdated) {\n        if (hoveredAnnotationIds.length > 0) {\n          this.osdCanvasOverlay.canvasDiv.style.cursor = 'pointer';\n        } else {\n          this.osdCanvasOverlay.canvasDiv.style.cursor = '';\n        }\n      }\n\n      var selectedAnnotationsUpdated = selectedAnnotationId !== prevProps.selectedAnnotationId;\n      var redrawAnnotations = drawAnnotations !== prevProps.drawAnnotations || drawSearchAnnotations !== prevProps.drawSearchAnnotations || highlightAllAnnotations !== prevProps.highlightAllAnnotations;\n\n      if (searchAnnotationsUpdated || annotationsUpdated || selectedAnnotationsUpdated || hoveredAnnotationsUpdated || redrawAnnotations) {\n        this.updateCanvas = this.canvasUpdateCallback();\n        viewer.forceRedraw();\n      }\n    }\n    /**\n     */\n\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var viewer = this.props.viewer;\n      viewer.removeHandler('canvas-click', this.onCanvasClick);\n      viewer.removeHandler('canvas-exit', this.onCanvasExit);\n      viewer.removeHandler('update-viewport', this.onUpdateViewport);\n      viewer.removeHandler('mouse-move', this.onCanvasMouseMove);\n    }\n    /** */\n\n  }, {\n    key: \"onCanvasClick\",\n    value: function onCanvasClick(event) {\n      var _this2 = this;\n\n      var canvasWorld = this.props.canvasWorld;\n      var webPosition = event.position,\n          viewport = event.eventSource.viewport;\n      var point = viewport.pointFromPixel(webPosition);\n      var canvas = canvasWorld.canvasAtPoint(point);\n      if (!canvas) return;\n\n      var _canvasWorld$canvasTo = canvasWorld.canvasToWorldCoordinates(canvas.id),\n          _canvasWorld$canvasTo2 = _slicedToArray(_canvasWorld$canvasTo, 4),\n          _canvasX = _canvasWorld$canvasTo2[0],\n          _canvasY = _canvasWorld$canvasTo2[1],\n          canvasWidth = _canvasWorld$canvasTo2[2],\n          canvasHeight // eslint-disable-line no-unused-vars\n      = _canvasWorld$canvasTo2[3]; // get all the annotations that contain the click\n\n\n      var annos = this.annotationsAtPoint(canvas, point);\n\n      if (annos.length > 0) {\n        event.preventDefaultAction = true; // eslint-disable-line no-param-reassign\n      }\n\n      if (annos.length === 1) {\n        this.toggleAnnotation(annos[0].id);\n      } else if (annos.length > 0) {\n        /**\n         * Try to find the \"right\" annotation to select after a click.\n         *\n         * This is perhaps a naive method, but seems to deal with rectangles and SVG shapes:\n         *\n         * - figure out how many points around a circle are inside the annotation shape\n         * - if there's a shape with the fewest interior points, it's probably the one\n         *       with the closest boundary?\n         * - if there's a tie, make the circle bigger and try again.\n         */\n        var annosWithClickScore = function annosWithClickScore(radius) {\n          var degreesToRadians = Math.PI / 180;\n          return function (anno) {\n            var score = 0;\n\n            for (var degrees = 0; degrees < 360; degrees += 1) {\n              var x = Math.cos(degrees * degreesToRadians) * radius + point.x;\n              var y = Math.sin(degrees * degreesToRadians) * radius + point.y;\n              if (_this2.isAnnotationAtPoint(anno, canvas, {\n                x: x,\n                y: y\n              })) score += 1;\n            }\n\n            return {\n              anno: anno,\n              score: score\n            };\n          };\n        };\n\n        var annosWithScore = [];\n        var radius = 1;\n        annosWithScore = sortBy(annos.map(annosWithClickScore(radius)), 'score');\n\n        while (radius < Math.max(canvasWidth, canvasHeight) && annosWithScore[0].score === annosWithScore[1].score) {\n          radius *= 2;\n          annosWithScore = sortBy(annos.map(annosWithClickScore(radius)), 'score');\n        }\n\n        this.toggleAnnotation(annosWithScore[0].anno.id);\n      }\n    }\n    /** */\n\n  }, {\n    key: \"onCanvasMouseMove\",\n    value: function onCanvasMouseMove(event) {\n      var _this$props2 = this.props,\n          annotations = _this$props2.annotations,\n          canvasWorld = _this$props2.canvasWorld,\n          hoverAnnotation = _this$props2.hoverAnnotation,\n          hoveredAnnotationIds = _this$props2.hoveredAnnotationIds,\n          searchAnnotations = _this$props2.searchAnnotations,\n          viewer = _this$props2.viewer,\n          windowId = _this$props2.windowId;\n      if (annotations.length === 0 && searchAnnotations.length === 0) return;\n      var webPosition = event.position;\n      var point = viewer.viewport.pointFromPixel(webPosition);\n      var canvas = canvasWorld.canvasAtPoint(point);\n\n      if (!canvas) {\n        hoverAnnotation(windowId, []);\n        return;\n      }\n\n      var annos = this.annotationsAtPoint(canvas, point);\n\n      if (xor(hoveredAnnotationIds, annos.map(function (a) {\n        return a.id;\n      })).length > 0) {\n        hoverAnnotation(windowId, annos.map(function (a) {\n          return a.id;\n        }));\n      }\n    }\n    /** If the cursor leaves the canvas, wipe out highlights */\n\n  }, {\n    key: \"onCanvasExit\",\n    value: function onCanvasExit(event) {\n      var _this$props3 = this.props,\n          hoverAnnotation = _this$props3.hoverAnnotation,\n          windowId = _this$props3.windowId; // a move event may be queued up by the debouncer\n\n      this.onCanvasMouseMove.cancel();\n      hoverAnnotation(windowId, []);\n    }\n    /**\n     * onUpdateViewport - fires during OpenSeadragon render method.\n     */\n\n  }, {\n    key: \"onUpdateViewport\",\n    value: function onUpdateViewport(event) {\n      this.updateCanvas();\n    }\n    /** @private */\n\n  }, {\n    key: \"initializeViewer\",\n    value: function initializeViewer() {\n      var viewer = this.props.viewer;\n      if (!viewer) return;\n      if (this.osdCanvasOverlay) return;\n      this.osdCanvasOverlay = new OpenSeadragonCanvasOverlay(viewer, this.ref);\n      viewer.addHandler('canvas-click', this.onCanvasClick);\n      viewer.addHandler('canvas-exit', this.onCanvasExit);\n      viewer.addHandler('update-viewport', this.onUpdateViewport);\n      viewer.addHandler('mouse-move', this.onCanvasMouseMove);\n      this.updateCanvas = this.canvasUpdateCallback();\n    }\n    /** */\n\n  }, {\n    key: \"canvasUpdateCallback\",\n    value: function canvasUpdateCallback() {\n      var _this3 = this;\n\n      return function () {\n        _this3.osdCanvasOverlay.clear();\n\n        _this3.osdCanvasOverlay.resize();\n\n        _this3.osdCanvasOverlay.canvasUpdate(_this3.renderAnnotations.bind(_this3));\n      };\n    }\n    /** @private */\n\n  }, {\n    key: \"isAnnotationAtPoint\",\n    value: function isAnnotationAtPoint(resource, canvas, point) {\n      var canvasWorld = this.props.canvasWorld;\n\n      var _canvasWorld$canvasTo3 = canvasWorld.canvasToWorldCoordinates(canvas.id),\n          _canvasWorld$canvasTo4 = _slicedToArray(_canvasWorld$canvasTo3, 2),\n          canvasX = _canvasWorld$canvasTo4[0],\n          canvasY = _canvasWorld$canvasTo4[1];\n\n      var relativeX = point.x - canvasX;\n      var relativeY = point.y - canvasY;\n\n      if (resource.svgSelector) {\n        var context = this.osdCanvasOverlay.context2d;\n\n        var _CanvasAnnotationDisp = new CanvasAnnotationDisplay({\n          resource: resource\n        }),\n            svgPaths = _CanvasAnnotationDisp.svgPaths;\n\n        return _toConsumableArray(svgPaths).some(function (path) {\n          return context.isPointInPath(new Path2D(path.attributes.d.nodeValue), relativeX, relativeY);\n        });\n      }\n\n      if (resource.fragmentSelector) {\n        var _resource$fragmentSel = _slicedToArray(resource.fragmentSelector, 4),\n            x = _resource$fragmentSel[0],\n            y = _resource$fragmentSel[1],\n            w = _resource$fragmentSel[2],\n            h = _resource$fragmentSel[3];\n\n        return x <= relativeX && relativeX <= x + w && y <= relativeY && relativeY <= y + h;\n      }\n\n      return false;\n    }\n    /** @private */\n\n  }, {\n    key: \"annotationsAtPoint\",\n    value: function annotationsAtPoint(canvas, point) {\n      var _this4 = this;\n\n      var _this$props4 = this.props,\n          annotations = _this$props4.annotations,\n          searchAnnotations = _this$props4.searchAnnotations;\n      var lists = [].concat(_toConsumableArray(annotations), _toConsumableArray(searchAnnotations));\n      var annos = flatten(lists.map(function (l) {\n        return l.resources;\n      })).filter(function (resource) {\n        if (canvas.id !== resource.targetId) return false;\n        return _this4.isAnnotationAtPoint(resource, canvas, point);\n      });\n      return annos;\n    }\n    /** */\n\n  }, {\n    key: \"toggleAnnotation\",\n    value: function toggleAnnotation(id) {\n      var _this$props5 = this.props,\n          selectedAnnotationId = _this$props5.selectedAnnotationId,\n          selectAnnotation = _this$props5.selectAnnotation,\n          deselectAnnotation = _this$props5.deselectAnnotation,\n          windowId = _this$props5.windowId;\n\n      if (selectedAnnotationId === id) {\n        deselectAnnotation(windowId, id);\n      } else {\n        selectAnnotation(windowId, id);\n      }\n    }\n    /**\n     * annotationsToContext - converts anontations to a canvas context\n     */\n\n  }, {\n    key: \"annotationsToContext\",\n    value: function annotationsToContext(annotations, palette) {\n      var _this$props6 = this.props,\n          highlightAllAnnotations = _this$props6.highlightAllAnnotations,\n          hoveredAnnotationIds = _this$props6.hoveredAnnotationIds,\n          selectedAnnotationId = _this$props6.selectedAnnotationId,\n          canvasWorld = _this$props6.canvasWorld,\n          viewer = _this$props6.viewer;\n      var context = this.osdCanvasOverlay.context2d;\n      var zoomRatio = viewer.viewport.getZoom(true) / viewer.viewport.getMaxZoom();\n      annotations.forEach(function (annotation) {\n        annotation.resources.forEach(function (resource) {\n          if (!canvasWorld.canvasIds.includes(resource.targetId)) return;\n          var offset = canvasWorld.offsetByCanvas(resource.targetId);\n          var canvasAnnotationDisplay = new CanvasAnnotationDisplay({\n            hovered: hoveredAnnotationIds.includes(resource.id),\n            offset: offset,\n            palette: _objectSpread(_objectSpread({}, palette), {}, {\n              \"default\": _objectSpread(_objectSpread({}, palette[\"default\"]), !highlightAllAnnotations && palette.hidden)\n            }),\n            resource: resource,\n            selected: selectedAnnotationId === resource.id,\n            zoomRatio: zoomRatio\n          });\n          canvasAnnotationDisplay.toContext(context);\n        });\n      });\n    }\n    /** */\n\n  }, {\n    key: \"renderAnnotations\",\n    value: function renderAnnotations() {\n      var _this$props7 = this.props,\n          annotations = _this$props7.annotations,\n          drawAnnotations = _this$props7.drawAnnotations,\n          drawSearchAnnotations = _this$props7.drawSearchAnnotations,\n          searchAnnotations = _this$props7.searchAnnotations,\n          palette = _this$props7.palette;\n\n      if (drawSearchAnnotations) {\n        this.annotationsToContext(searchAnnotations, palette.search);\n      }\n\n      if (drawAnnotations) {\n        this.annotationsToContext(annotations, palette.annotations);\n      }\n    }\n    /**\n     * Renders things\n     */\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var viewer = this.props.viewer;\n      if (!viewer) return /*#__PURE__*/React.createElement(React.Fragment, null);\n      return /*#__PURE__*/ReactDOM.createPortal( /*#__PURE__*/React.createElement(\"div\", {\n        ref: this.ref,\n        style: {\n          height: '100%',\n          left: 0,\n          position: 'absolute',\n          top: 0,\n          width: '100%'\n        }\n      }, /*#__PURE__*/React.createElement(\"canvas\", null)), viewer.canvas);\n    }\n  }], [{\n    key: \"annotationsMatch\",\n    value:\n    /**\n     * annotationsMatch - compares previous annotations to current to determine\n     * whether to add a new updateCanvas method to draw annotations\n     * @param  {Array} currentAnnotations\n     * @param  {Array} prevAnnotations\n     * @return {Boolean}\n     */\n    function annotationsMatch(currentAnnotations, prevAnnotations) {\n      if (!currentAnnotations && !prevAnnotations) return true;\n      if (currentAnnotations && !prevAnnotations || !currentAnnotations && prevAnnotations) return false;\n      if (currentAnnotations.length === 0 && prevAnnotations.length === 0) return true;\n      if (currentAnnotations.length !== prevAnnotations.length) return false;\n      return currentAnnotations.every(function (annotation, index) {\n        var newIds = annotation.resources.map(function (r) {\n          return r.id;\n        });\n        var prevIds = prevAnnotations[index].resources.map(function (r) {\n          return r.id;\n        });\n        if (newIds.length === 0 && prevIds.length === 0) return true;\n        if (newIds.length !== prevIds.length) return false;\n\n        if (annotation.id === prevAnnotations[index].id && isEqual(newIds, prevIds)) {\n          return true;\n        }\n\n        return false;\n      });\n    }\n  }]);\n\n  return AnnotationsOverlay;\n}(Component);\nAnnotationsOverlay.defaultProps = {\n  annotations: [],\n  deselectAnnotation: function deselectAnnotation() {},\n  drawAnnotations: true,\n  drawSearchAnnotations: true,\n  highlightAllAnnotations: false,\n  hoverAnnotation: function hoverAnnotation() {},\n  hoveredAnnotationIds: [],\n  palette: {},\n  searchAnnotations: [],\n  selectAnnotation: function selectAnnotation() {},\n  selectedAnnotationId: undefined,\n  viewer: null\n};","import { compose } from 'redux';\nimport { connect } from 'react-redux';\nimport { withTranslation } from 'react-i18next';\nimport { withPlugins } from '../extend/withPlugins';\nimport { AnnotationsOverlay } from '../components/AnnotationsOverlay';\nimport * as actions from '../state/actions';\nimport { getWindow, getSearchAnnotationsForWindow, getCompanionWindowsForContent, getTheme, getConfig, getPresentAnnotationsOnSelectedCanvases, getSelectedAnnotationId, getCurrentCanvasWorld } from '../state/selectors';\n/**\n * mapStateToProps - used to hook up connect to action creators\n * @memberof Window\n * @private\n */\n\nvar mapStateToProps = function mapStateToProps(state, _ref) {\n  var windowId = _ref.windowId;\n  return {\n    annotations: getPresentAnnotationsOnSelectedCanvases(state, {\n      windowId: windowId\n    }),\n    canvasWorld: getCurrentCanvasWorld(state, {\n      windowId: windowId\n    }),\n    drawAnnotations: getConfig(state).window.forceDrawAnnotations || getCompanionWindowsForContent(state, {\n      content: 'annotations',\n      windowId: windowId\n    }).length > 0,\n    drawSearchAnnotations: getConfig(state).window.forceDrawAnnotations || getCompanionWindowsForContent(state, {\n      content: 'search',\n      windowId: windowId\n    }).length > 0,\n    highlightAllAnnotations: getWindow(state, {\n      windowId: windowId\n    }).highlightAllAnnotations,\n    hoveredAnnotationIds: getWindow(state, {\n      windowId: windowId\n    }).hoveredAnnotationIds,\n    palette: getTheme(state).palette,\n    searchAnnotations: getSearchAnnotationsForWindow(state, {\n      windowId: windowId\n    }),\n    selectedAnnotationId: getSelectedAnnotationId(state, {\n      windowId: windowId\n    })\n  };\n};\n/**\n * mapDispatchToProps - used to hook up connect to action creators\n * @memberof ManifestListItem\n * @private\n */\n\n\nvar mapDispatchToProps = {\n  deselectAnnotation: actions.deselectAnnotation,\n  hoverAnnotation: actions.hoverAnnotation,\n  selectAnnotation: actions.selectAnnotation\n};\nvar enhance = compose(withTranslation(), connect(mapStateToProps, mapDispatchToProps), withPlugins('AnnotationsOverlay'));\nexport default enhance(AnnotationsOverlay);","export var OSDReferences = {\n  /** */\n  get: function get(windowId) {\n    return this.refs[windowId];\n  },\n  refs: {},\n\n  /** */\n  set: function set(windowId, ref) {\n    this.refs[windowId] = ref;\n  }\n};","function _construct(Parent, args, Class) { if (_isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (typeof call === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nimport React, { Component } from 'react';\nimport debounce from 'lodash/debounce';\nimport isEqual from 'lodash/isEqual';\nimport OpenSeadragon from 'openseadragon';\nimport classNames from 'classnames';\nimport ns from '../config/css-ns';\nimport AnnotationsOverlay from '../containers/AnnotationsOverlay';\nimport CanvasWorld from '../lib/CanvasWorld';\nimport { PluginHook } from './PluginHook';\nimport { OSDReferences } from '../plugins/OSDReferences';\n/**\n * Represents a OpenSeadragonViewer in the mirador workspace. Responsible for mounting\n * and rendering OSD.\n */\n\nexport var OpenSeadragonViewer = /*#__PURE__*/function (_Component) {\n  _inherits(OpenSeadragonViewer, _Component);\n\n  var _super = _createSuper(OpenSeadragonViewer);\n\n  /**\n   * @param {Object} props\n   */\n  function OpenSeadragonViewer(props) {\n    var _this;\n\n    _classCallCheck(this, OpenSeadragonViewer);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      viewer: undefined\n    };\n    _this.ref = /*#__PURE__*/React.createRef();\n    _this.apiRef = /*#__PURE__*/React.createRef();\n    OSDReferences.set(props.windowId, _this.apiRef);\n    _this.onCanvasMouseMove = debounce(_this.onCanvasMouseMove.bind(_assertThisInitialized(_this)), 10);\n    _this.onViewportChange = _this.onViewportChange.bind(_assertThisInitialized(_this));\n    _this.zoomToWorld = _this.zoomToWorld.bind(_assertThisInitialized(_this));\n    _this.osdUpdating = false;\n    return _this;\n  }\n  /**\n   * React lifecycle event\n   */\n\n\n  _createClass(OpenSeadragonViewer, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          osdConfig = _this$props.osdConfig,\n          t = _this$props.t,\n          windowId = _this$props.windowId;\n\n      if (!this.ref.current) {\n        return;\n      }\n\n      var viewer = new OpenSeadragon(_objectSpread({\n        id: this.ref.current.id\n      }, osdConfig));\n      var canvas = viewer.canvas && viewer.canvas.firstElementChild;\n\n      if (canvas) {\n        canvas.setAttribute('role', 'img');\n        canvas.setAttribute('aria-label', t('digitizedView'));\n        canvas.setAttribute('aria-describedby', \"\".concat(windowId, \"-osd\"));\n      }\n\n      this.apiRef.current = viewer;\n      this.setState({\n        viewer: viewer\n      }); // Set a flag when OSD starts animating (so that viewer updates are not used)\n\n      viewer.addHandler('animation-start', function () {\n        _this2.osdUpdating = true;\n      });\n      viewer.addHandler('animation-finish', this.onViewportChange);\n      viewer.addHandler('animation-finish', function () {\n        _this2.osdUpdating = false;\n      });\n\n      if (viewer.innerTracker) {\n        viewer.innerTracker.moveHandler = this.onCanvasMouseMove;\n      }\n    }\n    /**\n     * When the tileSources change, make sure to close the OSD viewer.\n     * When the annotations change, reset the updateCanvas method to make sure\n     * they are added.\n     * When the viewport state changes, pan or zoom the OSD viewer as appropriate\n     */\n\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      var _this$props2 = this.props,\n          viewerConfig = _this$props2.viewerConfig,\n          canvasWorld = _this$props2.canvasWorld;\n      var viewer = this.state.viewer;\n      this.apiRef.current = viewer;\n\n      if (prevState.viewer === undefined) {\n        if (viewerConfig) {\n          viewer.viewport.panTo(viewerConfig, true);\n          viewer.viewport.zoomTo(viewerConfig.zoom, viewerConfig, true);\n          viewerConfig.degrees !== undefined && viewer.viewport.setRotation(viewerConfig.degrees);\n          viewerConfig.flip !== undefined && viewer.viewport.setFlip(viewerConfig.flip);\n        }\n\n        this.addAllImageSources(!viewerConfig);\n        return;\n      }\n\n      if (!this.infoResponsesMatch(prevProps.infoResponses) || !this.nonTiledImagedMatch(prevProps.nonTiledImages)) {\n        viewer.close();\n        var canvasesChanged = !isEqual(canvasWorld.canvasIds, prevProps.canvasWorld.canvasIds);\n        this.addAllImageSources(canvasesChanged || !viewerConfig);\n      } else if (!isEqual(canvasWorld.layers, prevProps.canvasWorld.layers)) {\n        this.refreshTileProperties();\n      } else if (viewerConfig && !this.osdUpdating) {\n        var viewport = viewer.viewport;\n\n        if (viewerConfig.x !== viewport.centerSpringX.target.value || viewerConfig.y !== viewport.centerSpringY.target.value) {\n          viewport.panTo(viewerConfig, false);\n        }\n\n        if (viewerConfig.zoom !== viewport.zoomSpring.target.value) {\n          viewport.zoomTo(viewerConfig.zoom, viewerConfig, false);\n        }\n\n        if (viewerConfig.rotation !== viewport.getRotation()) {\n          viewport.setRotation(viewerConfig.rotation);\n        }\n\n        if (viewerConfig.flip !== viewport.getFlip()) {\n          viewport.setFlip(viewerConfig.flip);\n        }\n      }\n    }\n    /**\n     */\n\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var viewer = this.state.viewer;\n\n      if (viewer.innerTracker && viewer.innerTracker.moveHandler === this.onCanvasMouseMove) {\n        viewer.innerTracker.moveHandler = null;\n      }\n\n      viewer.removeAllHandlers();\n      this.apiRef.current = undefined;\n    }\n    /** Shim to provide a mouse-move event coming from the viewer */\n\n  }, {\n    key: \"onCanvasMouseMove\",\n    value: function onCanvasMouseMove(event) {\n      var viewer = this.state.viewer;\n      viewer.raiseEvent('mouse-move', event);\n    }\n    /**\n     * Forward OSD state to redux\n     */\n\n  }, {\n    key: \"onViewportChange\",\n    value: function onViewportChange(event) {\n      var _this$props3 = this.props,\n          updateViewport = _this$props3.updateViewport,\n          windowId = _this$props3.windowId;\n      var viewport = event.eventSource.viewport;\n      updateViewport(windowId, {\n        flip: viewport.getFlip(),\n        rotation: viewport.getRotation(),\n        x: Math.round(viewport.centerSpringX.target.value),\n        y: Math.round(viewport.centerSpringY.target.value),\n        zoom: viewport.zoomSpring.target.value\n      });\n    }\n    /** */\n\n  }, {\n    key: \"addAllImageSources\",\n    value: function addAllImageSources() {\n      var _this3 = this;\n\n      var zoomAfterAdd = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      var _this$props4 = this.props,\n          nonTiledImages = _this$props4.nonTiledImages,\n          infoResponses = _this$props4.infoResponses;\n      Promise.all(infoResponses.map(function (infoResponse) {\n        return _this3.addTileSource(infoResponse);\n      }), nonTiledImages.map(function (image) {\n        return _this3.addNonTiledImage(image);\n      })).then(function () {\n        if (infoResponses[0] || nonTiledImages[0]) {\n          if (zoomAfterAdd) _this3.zoomToWorld();\n\n          _this3.refreshTileProperties();\n        }\n      });\n    }\n    /** */\n\n  }, {\n    key: \"addNonTiledImage\",\n    value: function addNonTiledImage(contentResource) {\n      var canvasWorld = this.props.canvasWorld;\n      var viewer = this.state.viewer;\n      var type = contentResource.getProperty('type');\n      var format = contentResource.getProperty('format') || '';\n      if (!(type === 'Image' || type === 'dctypes:Image' || format.startsWith('image/'))) return Promise.resolve();\n      return new Promise(function (resolve, reject) {\n        if (!viewer) {\n          reject();\n        }\n\n        viewer.addSimpleImage({\n          error: function error(event) {\n            return reject(event);\n          },\n          fitBounds: _construct(OpenSeadragon.Rect, _toConsumableArray(canvasWorld.contentResourceToWorldCoordinates(contentResource))),\n          index: canvasWorld.layerIndexOfImageResource(contentResource),\n          opacity: canvasWorld.layerOpacityOfImageResource(contentResource),\n          success: function success(event) {\n            return resolve(event);\n          },\n          url: contentResource.id\n        });\n      });\n    }\n    /**\n     */\n\n  }, {\n    key: \"addTileSource\",\n    value: function addTileSource(infoResponse) {\n      var canvasWorld = this.props.canvasWorld;\n      var viewer = this.state.viewer;\n      return new Promise(function (resolve, reject) {\n        if (!viewer) {\n          reject();\n        } // OSD mutates this object, so we give it a shallow copy\n\n\n        var tileSource = _objectSpread({}, infoResponse.json);\n\n        var contentResource = canvasWorld.contentResource(infoResponse.id);\n        if (!contentResource) return;\n        viewer.addTiledImage({\n          error: function error(event) {\n            return reject(event);\n          },\n          fitBounds: _construct(OpenSeadragon.Rect, _toConsumableArray(canvasWorld.contentResourceToWorldCoordinates(contentResource))),\n          index: canvasWorld.layerIndexOfImageResource(contentResource),\n          opacity: canvasWorld.layerOpacityOfImageResource(contentResource),\n          success: function success(event) {\n            return resolve(event);\n          },\n          tileSource: tileSource\n        });\n      });\n    }\n    /** */\n\n  }, {\n    key: \"refreshTileProperties\",\n    value: function refreshTileProperties() {\n      var canvasWorld = this.props.canvasWorld;\n      var world = this.state.viewer.world;\n      var items = [];\n\n      for (var i = 0; i < world.getItemCount(); i += 1) {\n        items.push(world.getItemAt(i));\n      }\n\n      items.forEach(function (item, i) {\n        var contentResource = canvasWorld.contentResource(item.source['@id'] || item.source.id);\n        if (!contentResource) return;\n        var newIndex = canvasWorld.layerIndexOfImageResource(contentResource);\n        if (i !== newIndex) world.setItemIndex(item, newIndex);\n        item.setOpacity(canvasWorld.layerOpacityOfImageResource(contentResource));\n      });\n    }\n    /**\n     */\n\n  }, {\n    key: \"fitBounds\",\n    value: function fitBounds(x, y, w, h) {\n      var immediately = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : true;\n      var viewer = this.state.viewer;\n      viewer.viewport.fitBounds(new OpenSeadragon.Rect(x, y, w, h), immediately);\n    }\n    /**\n     * infoResponsesMatch - compares previous tileSources to current to determine\n     * whether a refresh of the OSD viewer is needed.\n     * @param  {Array} prevTileSources\n     * @return {Boolean}\n     */\n\n  }, {\n    key: \"infoResponsesMatch\",\n    value: function infoResponsesMatch(prevInfoResponses) {\n      var infoResponses = this.props.infoResponses;\n      if (infoResponses.length === 0 && prevInfoResponses.length === 0) return true;\n      if (infoResponses.length !== prevInfoResponses.length) return false;\n      return infoResponses.every(function (infoResponse, index) {\n        if (!prevInfoResponses[index]) {\n          return false;\n        }\n\n        if (!infoResponse.json || !prevInfoResponses[index].json) {\n          return false;\n        }\n\n        if (infoResponse.tokenServiceId !== prevInfoResponses[index].tokenServiceId) {\n          return false;\n        }\n\n        if (infoResponse.json['@id'] && infoResponse.json['@id'] === prevInfoResponses[index].json['@id']) {\n          return true;\n        }\n\n        if (infoResponse.json.id && infoResponse.json.id === prevInfoResponses[index].json.id) {\n          return true;\n        }\n\n        return false;\n      });\n    }\n    /**\n     * nonTiledImagedMatch - compares previous images to current to determin\n     * whether a refresh of the OSD viewer is needed\n     */\n\n  }, {\n    key: \"nonTiledImagedMatch\",\n    value: function nonTiledImagedMatch(prevNonTiledImages) {\n      var nonTiledImages = this.props.nonTiledImages;\n      if (nonTiledImages.length === 0 && prevNonTiledImages.length === 0) return true;\n      return nonTiledImages.some(function (image, index) {\n        if (!prevNonTiledImages[index]) {\n          return false;\n        }\n\n        if (image.id === prevNonTiledImages[index].id) {\n          return true;\n        }\n\n        return false;\n      });\n    }\n    /**\n     * zoomToWorld - zooms the viewer to the extent of the canvas world\n     */\n\n  }, {\n    key: \"zoomToWorld\",\n    value: function zoomToWorld() {\n      var immediately = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      var canvasWorld = this.props.canvasWorld;\n      this.fitBounds.apply(this, _toConsumableArray(canvasWorld.worldBounds()).concat([immediately]));\n    }\n    /**\n     * Renders things\n     */\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var _this$props5 = this.props,\n          children = _this$props5.children,\n          classes = _this$props5.classes,\n          label = _this$props5.label,\n          t = _this$props5.t,\n          windowId = _this$props5.windowId,\n          drawAnnotations = _this$props5.drawAnnotations;\n      var viewer = this.state.viewer;\n      var enhancedChildren = React.Children.map(children, function (child) {\n        return /*#__PURE__*/React.cloneElement(child, {\n          zoomToWorld: _this4.zoomToWorld\n        });\n      });\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"section\", {\n        className: classNames(ns('osd-container'), classes.osdContainer),\n        id: \"\".concat(windowId, \"-osd\"),\n        ref: this.ref,\n        \"aria-label\": t('item', {\n          label: label\n        }),\n        \"aria-live\": \"polite\"\n      }, drawAnnotations && /*#__PURE__*/React.createElement(AnnotationsOverlay, {\n        viewer: viewer,\n        windowId: windowId\n      }), enhancedChildren, /*#__PURE__*/React.createElement(PluginHook, Object.assign({\n        viewer: viewer\n      }, _objectSpread(_objectSpread({}, this.props), {}, {\n        children: null\n      })))));\n    }\n  }]);\n\n  return OpenSeadragonViewer;\n}(Component);\nOpenSeadragonViewer.defaultProps = {\n  children: null,\n  drawAnnotations: false,\n  infoResponses: [],\n  label: null,\n  nonTiledImages: [],\n  osdConfig: {},\n  viewerConfig: null\n};","import { compose } from 'redux';\nimport { connect } from 'react-redux';\nimport { withTranslation } from 'react-i18next';\nimport { withStyles } from '@material-ui/core/styles';\nimport flatten from 'lodash/flatten';\nimport { withPlugins } from '../extend/withPlugins';\nimport { OpenSeadragonViewer } from '../components/OpenSeadragonViewer';\nimport * as actions from '../state/actions';\nimport { getVisibleCanvasNonTiledResources, getCurrentCanvas, getCanvasLabel, getViewer, getConfig, getCompanionWindowsForContent, selectInfoResponses, getCurrentCanvasWorld } from '../state/selectors';\n/**\n * mapStateToProps - used to hook up connect to action creators\n * @memberof Window\n * @private\n */\n\nvar mapStateToProps = function mapStateToProps(state, _ref) {\n  var windowId = _ref.windowId;\n  var canvasWorld = getCurrentCanvasWorld(state, {\n    windowId: windowId\n  });\n  var infoResponses = selectInfoResponses(state);\n  var imageServiceIds = flatten(canvasWorld.canvases.map(function (c) {\n    return c.imageServiceIds;\n  }));\n  return {\n    canvasWorld: canvasWorld,\n    drawAnnotations: getConfig(state).window.forceDrawAnnotations || getCompanionWindowsForContent(state, {\n      content: 'annotations',\n      windowId: windowId\n    }).length > 0 || getCompanionWindowsForContent(state, {\n      content: 'search',\n      windowId: windowId\n    }).length > 0,\n    infoResponses: imageServiceIds.map(function (id) {\n      return infoResponses[id];\n    }).filter(function (infoResponse) {\n      return infoResponse !== undefined && infoResponse.isFetching === false && infoResponse.error === undefined;\n    }),\n    label: getCanvasLabel(state, {\n      canvasId: (getCurrentCanvas(state, {\n        windowId: windowId\n      }) || {}).id,\n      windowId: windowId\n    }),\n    nonTiledImages: getVisibleCanvasNonTiledResources(state, {\n      windowId: windowId\n    }),\n    osdConfig: getConfig(state).osdConfig,\n    viewerConfig: getViewer(state, {\n      windowId: windowId\n    })\n  };\n};\n/**\n * mapDispatchToProps - used to hook up connect to action creators\n * @memberof ManifestListItem\n * @private\n */\n\n\nvar mapDispatchToProps = {\n  updateViewport: actions.updateViewport\n};\nvar styles = {\n  osdContainer: {\n    flex: 1,\n    position: 'relative'\n  }\n};\nvar enhance = compose(withStyles(styles), withTranslation(), connect(mapStateToProps, mapDispatchToProps), withPlugins('OpenSeadragonViewer'));\nexport default enhance(OpenSeadragonViewer);"],"sourceRoot":""}